---
title: "AWS Lambda で環境変数を扱うときのおぼえがき"
emoji: "🗂"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "lambda"]
published: true
---

# はじめに
AWS Lambda で環境変数を扱う際、Lambda に付随した環境変数の管理機能を使うべきか Secrets Manager を使用すべきかでちょっと調べごとをしたのでおぼえがき。

## 公式の見解
Secrets Manager が推奨されています。

https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/configuration-envvars.html

> セキュリティを強化するには、データベースの認証情報や API キーや認可トークンなどその他の機密情報を保存するために、環境変数の代わりに AWS Secrets Manager を使用することをお勧めします。詳細については、「Lambda 関数で Secrets Manager シークレットを使用する」を参照してください。

なので、仕事とかではとりあえずこっちを使います。
ただ、Lambda にも環境変数の保存機能があり、そっちはどうなんだろうということで調べました。

## Lambda の環境変数
まずは環境変数の露出について。公式ドキュメントを読んだ感じ、環境変数は保管時に暗号化されているようです。また、暗号化に関するいくつかのオプションも確認できました。

https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/configuration-envvars.html

> Lambda は、環境変数を保管時に暗号化して安全に保存します。別の暗号化キーを使用したり、クライアント側で環境変数値を暗号化したり、CloudFormation テンプレートで AWS Secrets Manager を使用して環境変数を設定したりするように Lambda を設定できます。

ただし、Securets Manager と違ってコンソール上に環境変数が露出してるので、複数人での開発等では使用を控えたほうがよさそう。
管理する単位がLambdaごとなので、複数リソースで使いまわす場合は Secrets Manager のほうがよさそうですね。

基本的なセキュリティは問題ないことと、なにより使い勝手はこちらがよさそうなので、個人開発ではこちらを使うことにします。